<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>行き先リスト</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
      max-width: 700px;
      font-size: 20px;
    }

    #nextDisplay {
      font-size: 2.5em; /* 小さめに変更 */
      font-weight: bold;
      margin-bottom: 1em;
      border-bottom: 4px solid #000;
      padding-bottom: 0.2em;
    }

    #places { user-select: none; }

    .place {
      border: none;
      padding: 0.8em 0;
      margin-bottom: 0.5em;
      cursor: pointer;
      border-bottom: 1px solid #ccc;
      font-size: 1.4em;
    }

    .todos {
      display: none;
      margin-top: 0.4em;
      font-size: 0.9em;
    }

    .edit-controls button {
      margin-left: 0.4em;
    }

    body.editing .place {
      cursor: default;
    }

    body.editing .todos {
      display: none;
    }

    #editBtn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      font-size: 1em;
      padding: 0.5em 1em;
      z-index: 1000;
      background: #007bff;
      color: white;
      border: none;
      border-radius: 0.5em;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>

<div id="nextDisplay">Next: -</div>
<div id="places"></div>
<button id="editBtn">編集モード ON</button>

<script>
  const data = [
    {name: "渋谷",   todos: ["カフェで休憩", "映画館"], hidden: false},
    {name: "新宿",   todos: ["ショッピング", "ランチ"], hidden: false},
    {name: "秋葉原", todos: ["電気街散策", "メイド喫茶"], hidden: false},
  ];

  let editing = false;

  document.getElementById("editBtn").addEventListener("click", () => {
    editing = !editing;
    document.body.classList.toggle("editing", editing);
    document.getElementById("editBtn").textContent = editing ? "編集モード OFF" : "編集モード ON";
    render();
  });

  function render() {
    const placesDiv = document.getElementById("places");
    placesDiv.innerHTML = "";

    const visible = data.filter(d => !d.hidden);
    const nextPlace = visible.length ? visible[0] : null;
    document.getElementById("nextDisplay").textContent =
      nextPlace ? `Next: ${nextPlace.name}` : "Next: -";

    data.forEach((place, idx) => {
      // 通常モードでは Next のものをスキップ
      if (!editing && place === nextPlace) return;

      const div = document.createElement("div");
      div.className = "place";
      div.textContent = place.name;

      const todoDiv = document.createElement("div");
      todoDiv.className = "todos";
      place.todos.forEach(todo => {
        const item = document.createElement("div");
        item.textContent = "・" + todo;
        todoDiv.appendChild(item);
      });
      div.appendChild(todoDiv);

      if (!editing) {
        div.addEventListener("click", () => {
          todoDiv.style.display = todoDiv.style.display === "none" ? "block" : "none";
        });
      } else {
        const ctr = document.createElement("span");
        ctr.className = "edit-controls";

        const chk = document.createElement("input");
        chk.type = "checkbox";
        chk.checked = !place.hidden;
        chk.onchange = () => {
          place.hidden = !chk.checked;
          render();
        };

        const up = document.createElement("button");
        up.textContent = "↑";
        up.onclick = () => {
          if (idx > 0) {
            [data[idx - 1], data[idx]] = [data[idx], data[idx - 1]];
            render();
          }
        };

        const down = document.createElement("button");
        down.textContent = "↓";
        down.onclick = () => {
          if (idx < data.length - 1) {
            [data[idx + 1], data[idx]] = [data[idx], data[idx + 1]];
            render();
          }
        };

        ctr.append(chk, up, down);
        div.appendChild(ctr);
      }

      placesDiv.appendChild(div);
    });
  }

  render();
</script>

</body>
</html>
