<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>行き先リスト</title>
  <style>
    body { font-family: sans-serif; margin: 1em; }
    #next { font-size: 1.8em; font-weight: bold; margin-bottom: 1em; }
    .place { border: 1px solid #000; padding: 0.6em; margin-bottom: 0.4em; cursor: pointer; }
    .todos { display: none; font-size: 0.9em; margin-top: 0.4em; }
    .edit-btns { display: none; margin-top: 0.3em; }
    .edit-mode .edit-btns { display: block; }
    .hidden { display: none; }
    button { font-size: 0.9em; margin-right: 0.2em; }
  </style>
</head>
<body>
  <div id="next">Next: </div>
  <button onclick="toggleEdit()">編集</button>
  <div id="places"></div>

  <script>
    let editing = false;
    let data = [
      { name: "ららぽーと", todos: ["チャージ", "スリーブ購入"], hidden: false },
      { name: "平針", todos: ["ジムバ"], hidden: false },
      { name: "床屋", todos: ["散髪"], hidden: false },
      { name: "三洋堂", todos: ["e-hon", "フリューくじ"], hidden: false }
    ];

    function render() {
      const placesDiv = document.getElementById("places");
      placesDiv.innerHTML = "";

      const visible = data.filter(d => !d.hidden);
      document.getElementById("next").textContent = visible.length ? `Next: ${visible[0].name}` : "Next: -";

      data.forEach((place, index) => {
        const div = document.createElement("div");
        div.className = "place";
        if (!editing && place.hidden) div.classList.add("hidden");

        const label = document.createElement("span");
        label.textContent = place.name;
        div.appendChild(label);

        const todos = document.createElement("div");
        todos.className = "todos";
        place.todos.forEach(t => {
          const item = document.createElement("div");
          item.textContent = `・${t}`;
          todos.appendChild(item);
        });
        div.appendChild(todos);

        if (!editing) {
          div.onclick = () => {
            todos.style.display = todos.style.display === "none" ? "block" : "none";
          };
        } else {
          const controls = document.createElement("span");
          controls.className = "edit-btns";

          const check = document.createElement("input");
          check.type = "checkbox";
          check.checked = !place.hidden;
          check.onchange = () => {
            place.hidden = !check.checked;
            render();
          };

          const up = document.createElement("button");
          up.textContent = "↑";
          up.onclick = () => {
            if (index > 0) {
              [data[index - 1], data[index]] = [data[index], data[index - 1]];
              render();
            }
          };

          const down = document.createElement("button");
          down.textContent = "↓";
          down.onclick = () => {
            if (index < data.length - 1) {
              [data[index + 1], data[index]] = [data[index], data[index + 1]];
              render();
            }
          };

          controls.appendChild(check);
          controls.appendChild(up);
          controls.appendChild(down);
          div.appendChild(controls);
        }
        placesDiv.appendChild(div);
      });
    }

    function toggleEdit() {
      editing = !editing;
      document.body.classList.toggle("edit-mode", editing);
      render();
    }

    render();
  </script>
</body>
</html>
